import{_ as m,N as p,f as a,E as s,r as g,o as n,g as h,a as _,b as r,k as v,v as A,l as c,i as y,j as T}from"./NavBar-eaeb7c2f.js";/* empty css                     */import"./editormd-e007f7c4.js";const k={components:{NarBar:p},data(){return{info:{},userinfo:[],md:"# 请填写内容",id:"",title:"",content:"",state:"",pubAble:!1,saveAble:!1,TimeAble:!1,loading:!1,article:{},isget:!1,dialog:!1}},beforeMount(){a({method:"GET",url:"http://49.232.144.53:8080/islogin"}).then(t=>{t.data.code==200?this.userinfo=t.data.data:location.href="blog_login.html"}),a({method:"GET",url:"http://49.232.144.53:8080/article/getArticleById"+location.search}).then(t=>{t.data.code==200?(this.isget=!0,this.title=t.data.data.title,this.content=t.data.data.content,this.state=t.data.data.state,this.id=t.data.data.id,this.EdiotrInit(this.content)):(s.error("获取文章标题内容失败!"),this.EdiotrInit(this.content))})},mounted(){},methods:{EdiotrInit(t){this.editor=editormd("editorDiv",{width:"100%",height:"600px",markdown:t,path:"../assets/lib/editor.md/lib/",saveHTMLToTextarea:!0})},modify(t){if(!this.isget)return s.error("操作失败!"),!1;var e=this.editor.getValue(),o=this.title;(e==""||o=="")&&(s.error("标题或者内容不能为空!"),this.loading=!this.loading),this.pubAble=!0,this.saveAble=!0,this.TimeAble=!0,Number.isInteger(t)&&(this.state=t),a({method:"POST",url:"http://49.232.144.53:8080/article/update"+location.search,data:{id:this.id,title:o,content:e,state:this.state}}).then(u=>{u.data.code==200&&(s.success("恭喜你,更新文章成功!"),this.pubAble=!1,this.saveAble=!1,this.TimeAble=!1,confirm("是否继续更新文章?")||(location.href="blog_myblog.html"))})},pub(){if(!this.isget)return s.error("操作失败!"),!1;if(this.state==2)return this.modify(1),!0;var t=this.editor.getValue(),e=this.title;(t==""||e=="")&&(s.error("标题或者内容不能为空!"),this.loading=!this.loading),this.pubAble=!0,this.svaeAble=!0,this.TimeAble=!0,a({method:"POST",url:"http://49.232.144.53:8080/article/add",data:{title:e,content:t,state:1}}).then(o=>{o.data.code==200&&(s.success("恭喜你,保存草稿成功!"),this.pubAble=!1,this.svaeAble=!1,this.TimeAble=!1,confirm("是否继续添加草稿?")?(editor.setValue("# 请填写内容"),this.title="请填写标题"):location.href="blog_myblog.html")})}}},x={class:"blog-edit-container",id:"blog-edit-container"},E={class:"title"},N=["disabled"],B=["disabled"],V=r("div",{id:"editorDiv"},[r("textarea",{id:"editor-markdown",style:{display:"none"}})],-1);function w(t,e,o,u,i,d){const b=g("NarBar");return n(),h("div",null,[_(b,{img:"/img/bk.png",userinfo:i.userinfo},null,8,["userinfo"]),r("div",x,[r("div",E,[v(r("input",{type:"text",placeholder:"在这里写下文章标题",id:"add_title","onUpdate:modelValue":e[0]||(e[0]=l=>i.title=l)},null,512),[[A,i.title]]),i.state!=3?(n(),h("button",{key:0,onClick:e[1]||(e[1]=(...l)=>d.modify&&d.modify(...l)),id:"submit",disabled:i.saveAble},"更新文章",8,N)):c("",!0),i.state==2?(n(),h("button",{key:1,onClick:e[2]||(e[2]=(...l)=>d.pub&&d.pub(...l)),id:"submit",disabled:i.pubAble},"发布文章",8,B)):c("",!0)]),V])])}const C=m(k,[["render",w]]);a.defaults.withCredentials=!0;const f=y(C);f.use(T,a);f.mount("#app");
