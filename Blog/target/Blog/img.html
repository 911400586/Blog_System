<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

        <!-- type-text  键值对,方式提交 -->
        <!-- type=file  上传formData这种数据 -->
        <form action="" method="">
            value1: <input type="file" id="value1" name="v1" onchange="handleChange(this)" >
            <!-- value2: <input type="file" id="value2" name="v2"> -->
            <br>
            <button >提交</button>
        </form>
       
   
    <script src="js/Jquery.js"></script>
    <script>
    function handleChange(file) {
    var fileTypes = [".jpg", ".png",".jpeg"];  //我们所需要的图片格式
    var filePath = file.value;
    console.log(filePath);
    if (filePath) {
        
        var filePic = file.files[0];            //选择的文件内容--图片
        var fileType = filePath.slice(filePath.indexOf("."));   //选择文件的格式
        var fileSize = file.files[0].size;            //选择文件的大
        if (fileTypes.indexOf(fileType) == -1) {  //判断文件格式是否符合要求
            alert("文件格式不符合要求!");
            file.value ="";
            return false;
        }
        if (fileSize > 1024 * 1024) {
            alert("文件大小不能超过1M!");
            file.value="";
            return false;
        }
        return true;
    } else {
        alert("未知错误!");
        file.value="";
        return false;
    }
}
     $(function() {
         $('button').on('click', function(e) {
             e.preventDefault();
             // 1.先创建formData数据格式 传递HTML对象(文件上传推荐)
             var formData = new FormData($('form')[0]);
             // 2.把传递给服务器数据,追加到formData对象里面
             formData.append('val1', $('#value1').val());
             //formData.append('val2', $('#value2').val());
             //formData.append('val2', $('#value2').val());
             //删除数据
             // formData.delete('val1');
             //formData数据上传针对input=file ,在上传文件的时候采用
             //formData数据格式,大部分浏览器都支持formdata数据类型
             //使用serilayArray()只能传递普通参数
             //发送请求前判断文件符合要求
             
             //发送请求
             $.ajax({
                 url: 'img',
                 type: 'POST',
                 data: formData,
                 //如果提交数据格式为formData类型 必须加下面两句,不添加就报错
                 processData: false, //不希望使用   application/x-www-form-urlencoded
                 contentType: false, //不采用默认的数据类型 
                 //数据格式是 application/x-www-form-urlencoded
                 success: (res) => {
                 alert("上传成功!");
                 //location.assign("blog_list.html");   
                 },
                 error: function(err) {
                     console.log(err);
                 }
             })
         })
     }) 
    </script>
</body>
</html>